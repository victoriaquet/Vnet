@model SNC2017.Models.HistorialPrecioOferta

@{
    ViewBag.Title = "Editar precio";
}
<style>.form-group{ display: flex;margin-top: 0px}
 .padedit{padding-top:15px!important}
</style>
<input id="finiold" class="hidden" value="@Model.Oferta.HistorialPrecioOfertas.OrderByDescending(x => x.FechaInicio).ElementAt(1).FechaInicio.ToString("yyyy-MM-dd")" />

<div class="card">
    <div class="card-header" data-background-color="green" style="display: flex">
        <h4 class="title">Precio Oferta: @Model.Oferta.Nombre</h4>

    </div>

    <div class="card-content">
        
        <div id="example-tabs">
            <h3>Editar</h3>
            <section>
                @using (Html.BeginForm(null, null, FormMethod.Post, new { id = "myform" }))
                {
                    @Html.AntiForgeryToken()
                    @Html.ValidationSummary(true, "", new { @class = "text-danger" })
                    @Html.HiddenFor(model => model.IdOferta)
                    @Html.HiddenFor(model => model.IdHistorialPrecioOferta)



                    <div class="form-group">
                        @Html.LabelFor(model => model.FechaInicio, htmlAttributes: new { @class = " col-md-2 padedit" })
                        <div class="col-md-10">
                            <input class="form-control" id="FechaInicio" type="date" required  name="FechaInicio" value="@Model.FechaInicio.ToString("yyyy-MM-dd")" />

                            @*@Html.EditorFor(model => model.FechaInicio, new {htmlAttributes = new {@class = "form-control", @id = "FechaInicio"}})*@
                            @Html.ValidationMessageFor(model => model.FechaInicio, "", new {@class = "text-danger finierror"})
                        </div>
                    </div>
                    <div class="form-group">
                        @Html.LabelFor(model => model.Precio, htmlAttributes: new { @class = " col-md-2 padedit" })
                        <div class="col-md-10">
                            @Html.EditorFor(model => model.Precio, new { htmlAttributes = new { @class = "form-control",@required="required"} })
                            @Html.ValidationMessageFor(model => model.Precio, "", new { @class = "text-danger" })
                        </div>
                    </div>
                    
                    <div style="width: 100%;display: flex">
                        <div class="text-right" style="width: 30%">
                            <span value="Guardar" id="guardar" class="btn btn-success">Guardar</span>

                        </div>

                        <div class="text-center" style="width: 40%">
                        </div>
                        <div style="width: 30%"></div>
                    </div>
                    <div style="width: 100%;display: flex">
                        <div style="width: 30%">

                            @Html.ActionLink("Ir al listado", "Create", "HistorialPrecioOfertas", new{idoferta=Model.IdOferta}, new { @class = "btn btn-sm btn-default" })
                        </div>

                        <div class="text-center" style="width: 40%">
                            @*<input type="submit" value="Guardar" class="btn btn-success" />*@
                        </div>
                        <div style="width: 30%"></div>
                    </div>
                }
            </section>
        </div>
      
    </div>
</div>


@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
    <script>
        $(document).ready(function () {
            $.validator.messages.required = 'Completa este campo';
           


            $("#guardar").click(function () {
                
                var finiold = $("#finiold").val();
                var fininew = $("#FechaInicio").val();
                var validator = $("#myform").validate();

                if (Date.parse(fininew) <= Date.parse(finiold)) {
                    $(".finierror").html("La fecha debe ser posterior a " + finiold);
                } else { $(".finierror").html(""); $("#myform").submit() }

            });


        });

    </script>
}
